(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{1224:function(n,e,t){"use strict";t.r(e),t.d(e,"IntegrationMonitor",(function(){return Rn}));var i,r,a=t(9),o=t(38),s=t(81),c=t(140),d=t.n(c),l=t(1);t(597);function u(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}class p extends(Object(a.b)(a.a)(l.a)){static get properties(){return{pendings:Array,scenarios:Array,connections:Array}}static get styles(){return[s.c,Object(l.b)(i||(i=u(["\n        :host {\n          display: flex;\n          flex-direction: row;\n\n          overflow: hidden;\n          background-color: var(--paper-grey-800);\n          border-radius: var(--border-radius);\n          color: var(--opacity-light-color);\n        }\n\n        [card] {\n          flex: 1;\n          margin: var(--margin-default);\n          padding: var(--padding-narrow) var(--padding-default);\n          border-right: var(--border-light-color);\n        }\n        :host :last-child {\n          border-right: none;\n        }\n        strong {\n          font-size: 36px;\n          line-height: 30px;\n          color: var(--theme-white-color);\n        }\n        span {\n          display: block;\n          margin-bottom: var(--margin-narrow);\n          font-size: var(--fontsize-small);\n          text-transform: capitalize;\n        }\n        @media screen and (max-width: 480px) {\n          :host {\n            font-size: 0.8em;\n          }\n          [card] {\n            margin: var(--margin-narrow);\n            padding: var(--padding-narrow);\n          }\n          [card]:nth-child(5),\n          [card]:nth-child(6) {\n            display: none;\n          }\n          [card]:nth-child(4) {\n            border-right: none;\n          }\n          mwc-icon {\n            font-size: var(--fontsize-large);\n          }\n          span {\n            line-height: 1;\n          }\n          strong {\n            font-size: 24px;\n          }\n        }\n      "])))]}render(){var n=Date.now(),e=this.pendings||[],t=this.scenarios||[],i=this.connections||[];return[{title:"pending instances",icon:"update",value:e.length},{title:"due out instances",icon:"update_disabled",value:Math.max(0,e.concat({due:n+1}).findIndex(e=>Number(e.due)>n))},{title:"total scenarios",icon:"format_list_numbered",value:t.length},{title:"scenario instances",icon:"list_alt",value:t.reduce((n,e)=>n+e.instances.length,0)},{title:"connections",icon:"device_hub",value:i.length},{title:"active connections",icon:"fact_check",value:i.filter(n=>"CONNECTED"==n.state).length}].map(({title:n,icon:e,value:t})=>this.renderCard(n,e,t))}renderCard(n,e,t){return Object(l.e)(r||(r=u(["\n      <div card>\n        <span>","</span>\n        <mwc-icon>","</mwc-icon>\n        <strong> ","</strong>\n      </div>\n    "])),n,e,t)}}window.customElements.define("integration-summary",p);var v,b,m,f,g,h,w,y=t(993),x=t(942),O=t(31);function j(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function S(n){var e,t;function i(e,t){try{var a=n[e](t),o=a.value,s=o instanceof k;Promise.resolve(s?o.wrapped:o).then((function(n){s?i("return"===e?"return":"next",n):r(a.done?"return":"normal",n)}),(function(n){i("throw",n)}))}catch(n){r("throw",n)}}function r(n,r){switch(n){case"return":e.resolve({value:r,done:!0});break;case"throw":e.reject(r);break;default:e.resolve({value:r,done:!1})}(e=e.next)?i(e.key,e.arg):t=null}this._invoke=function(n,r){return new Promise((function(a,o){var s={key:n,arg:r,resolve:a,reject:o,next:null};t?t=t.next=s:(e=t=s,i(n,r))}))},"function"!=typeof n.return&&(this.return=void 0)}function k(n){this.wrapped=n}"function"==typeof Symbol&&Symbol.asyncIterator&&(S.prototype[Symbol.asyncIterator]=function(){return this}),S.prototype.next=function(n){return this._invoke("next",n)},S.prototype.throw=function(n){return this._invoke("throw",n)},S.prototype.return=function(n){return this._invoke("return",n)};class N extends l.a{static get styles(){return[s.c,Object(l.b)(v||(v=j(["\n        :host {\n          display: flex;\n          flex-direction: column;\n          background-color: rgba(var(--primary-color-rgb), 0.1);\n          border-radius: var(--border-radius);\n          padding: var(--padding-narrow);\n        }\n\n        div[tags] {\n          display: flex;\n          align-items: center;\n        }\n\n        select {\n          flex: 1;\n          display: inline-block;\n          border: none;\n          border-radius: var(--border-radius);\n        }\n\n        select:focus {\n          outline: 0;\n        }\n\n        [pendings] {\n          display: flex;\n\n          flex: 1;\n          position: relative;\n          overflow: auto;\n        }\n\n        [pending-wrap] {\n          flex: 1;\n          margin-top: var(--margin-default);\n          padding-left: 30px;\n          padding-right: 4px;\n          font-size: 8px;\n          line-height: 16px;\n\n          display: flex;\n        }\n\n        [pendings-by-tag] {\n          flex: 1;\n          position: relative;\n          margin: 0 1px;\n        }\n\n        [pending] {\n          display: block;\n          height: 2px;\n          width: 100%;\n          white-space: nowrap;\n          position: absolute;\n        }\n\n        [timeline] {\n          position: absolute;\n          width: 100%;\n        }\n        [timeline] table {\n          border-collapse: collapse;\n          margin-top: var(--margin-default);\n          width: 100%;\n        }\n        [timeline] th {\n          opacity: 0.5;\n          width: 25px;\n          border: 0;\n          font-weight: normal;\n          font-size: 9px;\n        }\n        [timeline] th span {\n          display: block;\n          position: absolute;\n          margin-top: -22px;\n        }\n        [timeline] td {\n          border: 0;\n          border-top: var(--border-dark-color);\n          height: 30px;\n          box-sizing: border-box;\n        }\n        [timeline] tr:nth-child(3n + 1) td {\n          border: 0;\n          border-top: 1px solid rgba(0, 0, 0, 0.4);\n          box-sizing: border-box;\n        }\n      "])))]}static get properties(){return{pendings:Array,filteredPendings:Array,colorIndex:Object,running:Boolean,tags:Object,tag:String,scales:Array}}render(){var n=void 0===this.tag?"(*)":this.tag,e=this.scales||[];return Object(l.e)(b||(b=j(["\n      <div tags>\n        <mwc-icon>bookmark_border</mwc-icon>\n        <select @change="," .value=",'>\n          <option value="(*)">*</option>\n          ',"\n        </select>\n      </div>\n\n      <div pendings>\n        <div timeline>\n          <table>\n            ","\n          </table>\n        </div>\n\n        <div pending-wrap>","</div>\n      </div>\n    "])),n=>this.tag=n.target.value,n,Object.keys(this.tags||{}).sort().map(n=>Object(l.e)(m||(m=j(["<option value=",">","</option>"])),n,n)),Object(y.a)(e.map(n=>"\n              <tr>\n                <th><span>".concat(n,"</span></th>\n                <td></td>\n              </tr>\n            ")).join("\n              <tr>\n                <th></th>\n                <td></td>\n              </tr>\n              <tr>\n                <th></th>\n                <td></td>\n              </tr>\n            ")),Object(x.a)(this.queue()))}queue(){var n,e=this;return(n=function*(){for(;e.running;){var n=Date.now(),t=Object.values(e.filterPendings||{});yield t.map(t=>Object(l.e)(f||(f=j(["\n          <div pendings-by-tag>\n            ","\n          </div>\n        "])),t.map((t,i)=>{var r=Number(t.due),a=Math.max(3*Math.floor((r-n)/1e3),0);return Object(l.e)(g||(g=j(['\n                <div pending .style="top:',"px;background-color:",';">\n                  ',"\n                </div>\n              "])),a,e.colorIndex[t.stuff.scenario],0==i?Object(l.e)(h||(h=j([" <div>","</div> "])),e.countdown(t.due,n)):Object(l.e)(w||(w=j([""]))))}))),yield(i=Object(O.m)(1e3),new k(i))}var i},function(){return new S(n.apply(this,arguments))})()}countdown(n,e){var t=(Number(n)-e)/1e3,i=Math.floor(Math.abs(t)),r=Math.floor(i/60),a=i-60*r;return"".concat(t>0?"":"-").concat(r?r+"m ":"").concat(a,"s")}buildFilterPendings(){var n,e;e=void 0===this.tag||"(*)"==this.tag?this.pendings||[]:(this.pendings||[]).filter(n=>n.tag==this.tag);var t=Date.now(),i=(null===(n=e[e.length-1])||void 0===n?void 0:n.due)||t,r=Math.max(5,Math.ceil((i-t)/6e4+1));this.scales=new Array(r).fill(0).map((n,e)=>["".concat(String(e).padStart(2,"0"),":00"),"".concat(String(e).padStart(2,"0"),":30")]).flat(),this.filterPendings=e.reduce((n,e)=>(n[e.tag]?n[e.tag].push(e):n[e.tag]=[e],n),{})}updated(n){n.has("pendings")&&(this.buildFilterPendings(),this.tags=(this.pendings||[]).reduce((n,e)=>(n[e.tag]=(n[e.tag]||0)+1,n),{})),n.has("tag")&&this.buildFilterPendings()}}customElements.define("pending-q-monitor",N);t(292);var z,P,I,E,D,C,$,_,A,q,T,M,U,L,B,V,H,Q,J,F,R,Y,G,K,W,X,Z,nn,en,tn,rn,an,on,sn,cn,dn,ln,un,pn,vn,bn=t(48),mn=(t(49),t(74));function fn(n,e,t,i,r,a,o){try{var s=n[a](o),c=s.value}catch(n){return void t(n)}s.done?e(c):Promise.resolve(c).then(i,r)}function gn(n){return function(){var e=this,t=arguments;return new Promise((function(i,r){var a=n.apply(e,t);function o(n){fn(a,i,r,o,s,"next",n)}function s(n){fn(a,i,r,o,s,"throw",n)}o(void 0)}))}}function hn(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}class wn extends(Object(mn.a)(o.store)(l.a)){static get styles(){return[s.c,Object(l.b)(z||(z=hn(["\n        :host {\n          display: flex;\n          flex-direction: column;\n          background-color: white;\n        }\n\n        [content] {\n          flex: 1;\n\n          display: flex;\n          flex-direction: column;\n          overflow: auto;\n\n          font-size: 0.8em;\n        }\n      "])))]}static get properties(){return{scenarioName:String,instanceName:String,logs:Array}}firstUpdated(){this.logs=[],this.startSubscribe()}disconnectedCallback(){super.disconnectedCallback(),this.stopSubscribe()}render(){var n=this.logs||[];return Object(l.e)(P||(P=hn(["\n      <div options></div>\n      <div content>\n        ","\n      </div>\n    "])),n.map(({timestamp:n,message:e,level:t})=>Object(l.e)(I||(I=hn([" <div>"," "," ","</div> "])),new Date(n).toLocaleString(),t,e)))}startSubscribe(){var n=this;return gn((function*(){var e;n.subscription=yield Object(o.subscribe)({query:d()(E||(E=hn(["\n          subscription($instanceName: String, $scenarioName: String, $level: String) {\n            log: scenarioInstanceLog(instanceName: $instanceName, scenarioName: $scenarioName, level: $level) {\n              level\n              message\n              timestamp\n            }\n          }\n        "]))),variables:{instanceName:n.instanceName,scenarioName:n.scenarioName}},{next:(e=gn((function*({data:e}){var t=n.scrollHeight-n.scrollTop===n.clientHeight;n.logs.push(e.log),n.logs.length>100&&n.logs.shift(),n.requestUpdate(),t&&(yield n.updateComplete,n.scrollTop=n.scrollHeight-n.clientHeight)})),function(n){return e.apply(this,arguments)})})}))()}stopSubscribe(){var n=this;return gn((function*(){var e;yield null===(e=n.subscription)||void 0===e?void 0:e.unsubscribe(),delete n.subscription}))()}}function yn(n,e,t,i,r,a,o){try{var s=n[a](o),c=s.value}catch(n){return void t(n)}s.done?e(c):Promise.resolve(c).then(i,r)}function xn(n){return function(){var e=this,t=arguments;return new Promise((function(i,r){var a=n.apply(e,t);function o(n){yn(a,i,r,o,s,"next",n)}function s(n){yn(a,i,r,o,s,"throw",n)}o(void 0)}))}}function On(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}customElements.define("scenario-instance-log-view",wn);class jn extends(Object(mn.a)(o.store)(l.a)){static get styles(){return[s.c,Object(l.b)(D||(D=On(["\n        :host {\n          display: flex;\n          flex-direction: column;\n\n          background-color: white;\n        }\n\n        [diagram] {\n          height: 200px;\n          border: 1px solid black;\n        }\n\n        [content] {\n          flex: 1;\n\n          display: flex;\n          flex-direction: column;\n          overflow: hidden;\n        }\n\n        [tab] {\n          display: flex;\n        }\n\n        [tab] span {\n          display: inline;\n          margin: 4px;\n          background-color: gray;\n        }\n\n        [tab] span[active] {\n          background-color: red;\n        }\n\n        [detail] {\n          flex: 1;\n\n          overflow: hidden;\n        }\n\n        [detail] > * {\n          display: none;\n          width: 100%;\n          height: 100%;\n          border: 1px solid black;\n        }\n\n        [detail] > [active] {\n          display: flex;\n          overflow: auto;\n        }\n\n        [detail] > [info] {\n          flex-direction: column;\n          background-color: white;\n        }\n\n        [detail] > [variables] {\n          background-color: white;\n        }\n\n        [keys] {\n          min-width: 200px;\n\n          margin: 0;\n          border: 1px solid black;\n        }\n\n        [value] {\n          flex: 1;\n          overflow: auto;\n\n          margin: 0;\n          border: 1px solid black;\n        }\n      "])))]}static get properties(){return{scenarioName:String,instanceName:String,instance:Object,tab:String,step:String,key:String,contextPath:String}}render(){var n=this.tab||"info",{scenarioName:e,instanceName:t,description:i,state:r,progress:a,variables:o,data:s,message:c}=this.instance||{},{rate:d=0,steps:u=0,step:p=0,rounds:v=0}=a||{},b="".concat(this.contextPath||"","/scenario-view/").concat(this.scenarioName);return Object(l.e)(C||(C=On(['\n      <iframe diagram src="','"></iframe>\n      <div content>\n        <div tab>\n          <span @click='," ?active=",">info</span>\n          <span @click="," ?active=",">variables</span>\n          <span @click="," ?active=",">data</span>\n          <span @click="," ?active=",">log</span>\n        </div>\n        <div detail>\n          <div info ?active=",">\n            <div>scenario name : ","</div>\n            <div>instance name : ","</div>\n            <div>description : ","</div>\n            <div>state : ","</div>\n            <div>total steps : ","</div>\n            <div>current step : ","</div>\n            <div>rounds : ","</div>\n            <div>messge : ","</div>\n          </div>\n          <div variables ?active=",">","</div>\n          <div data ?active=",">","</div>\n          <scenario-instance-log-view\n            log\n            ?active=","\n            .scenarioName=","\n            .instanceName=","\n          ></scenario-instance-log-view>\n        </div>\n      </div>\n    "])),b,n=>this.tab="info","info"==n,n=>this.tab="variables","variables"==n,n=>this.tab="data","data"==n,n=>this.tab="log","log"==n,"info"==n,e,t,i,r,u,p,v,c,"variables"==n,this.renderVariableObject(o),"data"==n,this.renderDataObject(s),"log"==n,this.scenarioName,this.instanceName)}firstUpdated(){this.startSubscribe()}disconnectedCallback(){super.disconnectedCallback(),this.stopSubscribe()}stateChanged(n){this.contextPath=n.app.contextPath}renderDataObject(n){var e=Object.keys(n||{});if(0==e.length)return Object(l.e)($||($=On(["<pre>no data</pre>"])));var t=this.step||e[0];return Object(l.e)(_||(_=On(["\n      <ul keys>\n        ","\n      </ul>\n      <div value>\n        <pre>","</pre>\n      </div>\n    "])),e.map(n=>Object(l.e)(A||(A=On(["<li @click=",">","</li>"])),e=>this.step=n,n)),n[t]?JSON.stringify(n[t],null,2):"")}renderVariableObject(n){var e=Object.keys(n||{});if(0==e.length)return Object(l.e)(q||(q=On(["<pre>no data</pre>"])));var t=this.key||e[0];return Object(l.e)(T||(T=On(["\n      <ul keys>\n        ","\n      </ul>\n      <div value>\n        <pre>","</pre>\n      </div>\n    "])),e.map(n=>Object(l.e)(M||(M=On(["<li @click=",">","</li>"])),e=>this.key=n,n)),n[t]?JSON.stringify(n[t],null,2):"")}startSubscribe(){var n=this;return xn((function*(){var e;n.subscription=yield Object(o.subscribe)({query:d()(U||(U=On(["\n          subscription($instanceName: String, $scenarioName: String) {\n            scenarioInstanceState(instanceName: $instanceName, scenarioName: $scenarioName) {\n              instanceName\n              scenarioName\n              state\n              progress {\n                rate\n                steps\n                step\n                rounds\n              }\n              variables\n              data\n            }\n          }\n        "]))),variables:{instanceName:n.instanceName,scenarioName:n.scenarioName}},{next:(e=xn((function*({data:e}){e&&(n.instance=e.scenarioInstanceState)})),function(n){return e.apply(this,arguments)})})}))()}stopSubscribe(){var n=this;return xn((function*(){var e;yield null===(e=n.subscription)||void 0===e?void 0:e.unsubscribe(),delete n.subscription}))()}}function Sn(n,e,t,i,r,a,o){try{var s=n[a](o),c=s.value}catch(n){return void t(n)}s.done?e(c):Promise.resolve(c).then(i,r)}function kn(n){return function(){var e=this,t=arguments;return new Promise((function(i,r){var a=n.apply(e,t);function o(n){Sn(a,i,r,o,s,"next",n)}function s(n){Sn(a,i,r,o,s,"throw",n)}o(void 0)}))}}function Nn(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function zn(n){return n&&"UNLOADED"!==n}customElements.define("scenario-instance-view",jn);class Pn extends(Object(a.b)(a.a)(l.a)){static get properties(){return{instance:Object,color:String}}static get styles(){return[s.c,Object(l.b)(L||(L=Nn(["\n        :host {\n          display: block;\n          overflow: hidden;\n          position: relative;\n          padding: var(--padding-narrow);\n          color: var(--secondary-color);\n        }\n\n        [running] {\n          background-color: lightgreen;\n        }\n\n        [name] {\n          font-size: var(--fontsize-default);\n          font-weight: bold;\n        }\n\n        [progress] {\n          display: block;\n          position: relative;\n\n          width: 100%;\n          margin: 2px;\n          padding: 2px;\n          box-sizing: border-box;\n\n          border: var(--border-dark-color);\n          border-radius: 10px;\n          background-color: var(--theme-white-color);\n        }\n        [progress-wrap] {\n          display: flex;\n          flex-direction: row;\n          margin: 4px 0;\n        }\n\n        [running] [progress] {\n          background-color: var(--theme-white-color);\n        }\n        [steps] {\n          padding: 0 0 0 var(--padding-narrow);\n        }\n\n        #progressbar {\n          height: 100%;\n          text-align: left;\n          border-radius: 5px;\n          animation: width 1s linear ease-out;\n        }\n        [buttons] {\n          --mdc-icon-button-size: 18px;\n          --mdc-icon-size: 18px;\n          border-top: var(--border-dark-color);\n          padding: var(--padding-narrow) 0 0 0;\n          text-align: right;\n        }\n        [buttons] mwc-icon-button {\n          color: var(--primary-color);\n        }\n\n        @keyframes width {\n          0% {\n            width: 0;\n          }\n          100% {\n            width: auto;\n          }\n        }\n      "])))]}render(){var n=this.instance,{instanceName:e,progress:t,message:i,state:r}=n,{rate:a=0,steps:o=0,step:s=0,rounds:c=0}=t||{},d=zn(r);return Object(l.e)(B||(B=Nn(["\n      <div name>",'</div>\n      <div progress-wrap>\n        <div progress>\n          <div id="progressbar" .style="width:',"%;background-color:",';"></div>\n        </div>\n        <div steps>',"/","</div>\n      </div>\n      <div buttons>\n        <span><strong>","</strong> round</span>\n        <mwc-icon-button @click=",' icon="wysiwyg"></mwc-icon-button>\n        <mwc-icon-button\n          @click=',"\n          icon=","\n        ></mwc-icon-button>\n      </div>\n    "])),e,a,this.color,s,o,c,n=>this.showInstanceDetail(),e=>d?this.stopScenario(n):this.startScenario(n),d?"pause":"play_arrow")}startScenario(n){return kn((function*(){var e=yield o.client.mutate({mutation:d()(V||(V=Nn(["\n        mutation($scenarioName: String!, $instanceName: String) {\n          startScenario(scenarioName: $scenarioName, instanceName: $instanceName) {\n            state\n          }\n        }\n      "]))),variables:{scenarioName:n.scenarioName,instanceName:n.instanceName}});Object(bn.h)({level:"info",message:"".concat(zn(e.data.startScenario.state)?"success":"fail"," to start scenario : ").concat(n.scenarioName)})}))()}stopScenario(n){return kn((function*(){var e=yield o.client.mutate({mutation:d()(H||(H=Nn(["\n        mutation($instanceName: String!) {\n          stopScenario(instanceName: $instanceName) {\n            state\n          }\n        }\n      "]))),variables:{instanceName:n.instanceName}});Object(bn.h)({level:"info",message:"".concat(zn(e.data.stopScenario.state)?"fail":"success"," to stop instance : ").concat(n.instanceName)})}))()}showInstanceDetail(){var n=this;return kn((function*(){var{instanceName:e,scenarioName:t}=n.instance;Object(bn.j)(Object(l.e)(Q||(Q=Nn(["\n        <scenario-instance-view .instanceName="," .scenarioName=","></scenario-instance-view>\n      "])),e,t),{size:"large",title:"".concat(a.a.t("title.scenario-instance"))})}))()}}function In(n,e,t,i,r,a,o){try{var s=n[a](o),c=s.value}catch(n){return void t(n)}s.done?e(c):Promise.resolve(c).then(i,r)}function En(n){return function(){var e=this,t=arguments;return new Promise((function(i,r){var a=n.apply(e,t);function o(n){In(a,i,r,o,s,"next",n)}function s(n){In(a,i,r,o,s,"throw",n)}o(void 0)}))}}function Dn(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function Cn(n){return n&&"UNLOADED"!==n}window.customElements.define("scenario-instance-monitor",Pn);class $n extends(Object(a.b)(a.a)(l.a)){static get properties(){return{scenario:Object,mode:String}}static get styles(){return[s.c,Object(l.b)(J||(J=Dn(["\n        :host {\n          display: flex;\n          flex-direction: row;\n          margin: var(--margin-default);\n\n          border: var(--border-dark-color);\n          background-color: var(--theme-white-color);\n          box-shadow: var(--box-shadow);\n          border-radius: var(--border-radius);\n          position: relative;\n          overflow: hidden;\n        }\n\n        [desc] {\n          position: relative;\n          display: flex;\n          flex-direction: column;\n          padding: var(--padding-default);\n          width: 200px;\n          color: var(--secondary-color);\n          font-size: var(--fontsize-small);\n        }\n\n        [desc] [detail-info] {\n          overflow: hidden;\n          text-overflow: ellipsis;\n          white-space: nowrap;\n          width: calc(100% - 25px);\n          height: 45px;\n        }\n\n        [desc] strong {\n          display: block;\n          overflow: hidden;\n          text-overflow: ellipsis;\n          white-space: nowrap;\n          font-size: var(--fontsize-large);\n        }\n\n        [desc] span {\n          display: block;\n          position: absolute;\n          top: 0px;\n          right: var(--padding-default);\n          font-size: 40px;\n          font-weight: bold;\n          text-align: right;\n        }\n\n        [desc] [schedule] * {\n          vertical-align: middle;\n          display: inline;\n        }\n\n        [desc] [schedule] {\n          background-color: #f1f1f1;\n          border-radius: 20px;\n          margin: var(--margin-default) 0;\n          padding: var(--padding-narrow);\n          overflow: hidden;\n          text-overflow: ellipsis;\n          white-space: nowrap;\n          font-size: 12px;\n          line-height: 8px;\n        }\n\n        [buttons] {\n          --mdc-icon-button-size: 24px;\n          --mdc-icon-size: 24px;\n          border-top: var(--border-dark-color);\n          padding: var(--padding-narrow) 0 0 0;\n          text-align: right;\n        }\n\n        [buttons] mwc-icon-button {\n          color: var(--primary-color);\n        }\n\n        [buttons][detail] {\n          display: flex;\n          flex-direction: column-reverse;\n          margin-bottom: auto;\n        }\n\n        [desc] mwc-icon {\n          border-radius: 50%;\n          color: var(--theme-white-color);\n          font-size: 18px;\n        }\n\n        :host([mode='detail']) [schedule] {\n          margin: var(--margin-default) 0 0 0;\n        }\n\n        :host([mode='detail']) [desc] [buttons] {\n          display: none;\n        }\n        :host([mode='detail']) [buttons] {\n          border-top: none;\n          padding: var(--padding-default);\n        }\n\n        ul {\n          flex: 1;\n\n          display: flex;\n          flex-direction: row;\n          flex-wrap: wrap;\n          list-style: none;\n          margin: 0;\n          padding: 0;\n        }\n\n        ul > li {\n          position: relative;\n          margin: var(--margin-default);\n          min-width: 140px;\n          max-width: 180px;\n          border: 1px solid black;\n          border-radius: var(--border-radius);\n          font-size: 12px;\n        }\n\n        li span {\n          display: block;\n          position: absolute;\n          width: 100%;\n          height: 100%;\n          background-color: rgba(255, 255, 255, 0.8);\n        }\n\n        @media screen and (max-width: 480px) {\n          :host {\n            margin: var(--margin-narrow);\n            max-width: 46%;\n          }\n\n          :host([mode='detail']) {\n            max-width: initial;\n          }\n\n          [desc] {\n            padding: var(--padding-narrow);\n          }\n\n          :host([mode='detail']) > [desc] {\n            max-width: 125px;\n          }\n\n          [desc] [detail-info] {\n            height: 38px;\n          }\n\n          [desc] span {\n            font-size: 36px;\n          }\n        }\n      "])))]}render(){var n=this.scenario||{},e=this.mode,{id:t,name:i,description:r,schedule:a,color:o}=n,s=n.instances||[];return Object(l.e)(F||(F=Dn(["\n      <div desc>\n        <div detail-info>\n          <strong>","</strong>\n          ","\n          <span>",'</span>\n        </div>\n        <div schedule>\n          <mwc-icon .style="background-color: ',';">schedule</mwc-icon>\n          <pre>',"</pre>\n        </div>\n        ","\n      </div>\n\n      ","\n    "])),i,r,s.length,o,a,this.renderButtons(n),"detail"===e?Object(l.e)(R||(R=Dn(["\n            <ul>\n              ","\n            </ul>\n            ","\n          "])),s.map(n=>Object(l.e)(Y||(Y=Dn(['\n                  <li .style="border-color:',";background-color:",'">\n                    <span></span>\n                    <scenario-instance-monitor .instance='," .color=","></scenario-instance-monitor>\n                  </li>\n                "])),o,o,n,o)),this.renderButtons(n)):Object(l.e)(G||(G=Dn([""]))))}renderButtons(n){var e=(n.instances||[]).find(e=>e.instanceName==n.name);return Object(l.e)(K||(K=Dn(["\n      <div buttons ?detail=",">\n        <mwc-icon-button @click=",' icon="text_snippet"></mwc-icon-button>\n        ',"\n      </div>\n    "])),"detail"==this.mode,e=>this.popupLogView(n),e?Object(l.e)(X||(X=Dn(['\n              <mwc-icon-button\n                icon="pause_circle_outline"\n                @click=',"\n                stop\n              ></mwc-icon-button>\n            "])),e=>this.stopScenario(n)):Object(l.e)(W||(W=Dn([' <mwc-icon-button\n              icon="play_circle_outline"\n              @click=',"\n            ></mwc-icon-button>"])),e=>this.startScenario(n)))}popupLogView(n){return En((function*(){Object(bn.j)(Object(l.e)(Z||(Z=Dn([" <scenario-instance-log-view .scenarioName=","></scenario-instance-log-view> "])),n.name),{size:"large",title:"".concat(a.a.t("title.scenario-log")," (").concat(n.name,")")})}))()}startScenario(n){return En((function*(){var e=yield o.client.mutate({mutation:d()(nn||(nn=Dn(["\n        mutation($scenarioName: String!) {\n          startScenario(scenarioName: $scenarioName) {\n            state\n          }\n        }\n      "]))),variables:{scenarioName:n.name}});Object(bn.h)({level:"info",message:"".concat(Cn(e.data.startScenario.state)?"success":"fail"," to start instance : ").concat(n.name)})}))()}stopScenario(n){return En((function*(){var e=yield o.client.mutate({mutation:d()(en||(en=Dn(["\n        mutation($instanceName: String!) {\n          stopScenario(instanceName: $instanceName) {\n            state\n          }\n        }\n      "]))),variables:{instanceName:n.name}});Object(bn.h)({level:"info",message:"".concat(Cn(e.data.stopScenario.state)?"fail":"success"," to stop instance : ").concat(n.name)})}))()}}function _n(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}window.customElements.define("scenario-monitor",$n);class An extends(Object(a.b)(a.a)(l.a)){static get properties(){return{scenarios:Array,mode:String,filter:String,pendings:Array,colorIndex:Object,running:Boolean}}static get styles(){return[s.c,Object(l.b)(tn||(tn=_n(["\n        :host {\n          display: flex;\n          flex-direction: column;\n\n          overflow: hidden;\n        }\n\n        [info] {\n          display: flex;\n          margin-bottom: var(--margin-default);\n          padding: var(--padding-narrow) 0;\n          flex-direction: row;\n          align-items: center;\n          border-bottom: 2px solid var(--secondary-color);\n        }\n        [info] h2 {\n          margin: 0;\n          font: var(--subtitle-font);\n          color: var(--secondary-color);\n          text-transform: capitalize;\n        }\n\n        [info] > span {\n          display: flex;\n          margin-left: auto;\n        }\n        [info] input {\n          margin: var(--input-margin);\n          padding: var(--padding-narrow);\n          border: var(--border-dark-color);\n          border-radius: var(--border-radius);\n          font: var(--input-font);\n        }\n        [info] mwc-icon {\n          margin-left: var(--margin-narrow);\n          color: rgba(var(--secondary-color-rgb), 0.6);\n          line-height: 34px;\n          cursor: pointer;\n        }\n        [info] mwc-icon[active] {\n          color: var(--primary-color);\n        }\n\n        [content] {\n          flex: 1;\n\n          display: flex;\n          flex-direction: row;\n\n          overflow: hidden;\n        }\n\n        pending-q-monitor {\n          width: 100px;\n        }\n\n        [scenarios] {\n          flex: 1;\n\n          overflow: auto;\n          display: flex;\n          flex-direction: column;\n        }\n\n        [scenarios] [flowbox] {\n          display: flex;\n          flex-direction: column;\n          min-height: min-content;\n        }\n\n        [scenarios][mode='brief'] [flowbox] {\n          flex-flow: row wrap;\n          align-self: start;\n        }\n\n        scenario-monitor {\n          flex: none;\n          height: fit-content;\n        }\n\n        @media screen and (max-width: 480px) {\n          pending-q-monitor {\n            width: 80px;\n          }\n        }\n      "])))]}render(){var n=this.scenarios||[],e=this.mode||"brief",t=this.filter||"";return Object(l.e)(rn||(rn=_n(["\n      <div info>\n        <h2>scenarios</h2>\n        <span>\n          <input .value="," @change=",' placeholder="search" />\n          <mwc-icon @click='," ?active=",">view_comfy</mwc-icon>\n          <mwc-icon @click="," ?active=",">dehaze</mwc-icon>\n        </span>\n      </div>\n\n      <div content>\n        <pending-q-monitor\n          .pendings=","\n          .colorIndex=","\n          .running=","\n        ></pending-q-monitor>\n\n        <div scenarios mode=",">\n          <div flowbox>\n            ","\n          </div>\n        </div>\n      </div>\n    "])),t,n=>this.filter=n.target.value,n=>this.mode="brief","brief"==e,n=>this.mode="detail","detail"==e,this.pendings,this.colorIndex||{},this.running,e,n.filter(n=>0==n.name.indexOf(t)).map(n=>Object(l.e)(an||(an=_n(["<scenario-monitor .scenario="," mode=","></scenario-monitor>"])),n,e)))}}function qn(n,e,t,i,r,a,o){try{var s=n[a](o),c=s.value}catch(n){return void t(n)}s.done?e(c):Promise.resolve(c).then(i,r)}function Tn(n){return function(){var e=this,t=arguments;return new Promise((function(i,r){var a=n.apply(e,t);function o(n){qn(a,i,r,o,s,"next",n)}function s(n){qn(a,i,r,o,s,"throw",n)}o(void 0)}))}}function Mn(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}window.customElements.define("scenarios-monitor",An);class Un extends l.a{static get styles(){return[s.c,Object(l.b)(on||(on=Mn(["\n        :host {\n          display: flex;\n          flex-direction: column;\n\n          overflow: hidden;\n          background-color: var(--theme-white-color);\n          border-radius: var(--border-radius);\n          border: var(--border-dark-color);\n        }\n        h2 {\n          margin: 0;\n          padding: var(--padding-default) 0 var(--padding-default) var(--padding-default);\n          border-bottom: var(--border-dark-color);\n          font: var(--subtitle-font);\n          color: var(--secondary-color);\n          text-transform: capitalize;\n        }\n\n        [cards] {\n          flex: 1;\n          display: flex;\n          flex-direction: column;\n\n          overflow: auto;\n        }\n\n        [card] {\n          display: flex;\n          flex-direction: column;\n          padding: var(--padding-default);\n          border-bottom: var(--border-dark-color);\n          color: var(--secondary-color);\n        }\n        [card] *{\n          overflow:hidden;\n          text-overflow:ellipsis;\n          white-space:nowrap;\n        }\n        [card] strong {\n          color: var(--primary-color);\n        }\n        [card] span {\n          font-size: var(--fontsize-default);\n          line-height: var(--fontsize-large);\n        }\n\n        [connected] strong::after {\n          content: '';\n          display: inline-block;\n          width: 10px;\n          height: 10px;\n          border-radius: 50%;\n          background-color: var(--status-success-color);\n          margin-left: var(--margin-narrow);\n        }\n        [buttons]{\n          --mdc-icon-button-size: 20px;\n          --mdc-icon-size: 20px;\n          border-top:1px dashed rgba(0,0,0,.1);\n          margin:var(--margin-narrow) 0 0 0;\n          padding:var(--padding-narrow) 0 0 0;\n          text-align:right;\n        }\n        [buttons] mwc-icon-button{\n          color:rgba(var(--secondary-color-rgb),.8);\n        }\n        @media screen and (max-width: 480px) {\n          h2 {\n            padding: var(--padding-narrow);\n          }\n          [card] span{\n            display:none\n          }\n        }\n      "])))]}static get properties(){return{connections:Array}}render(){var n=this.connections||[];return Object(l.e)(sn||(sn=Mn(["\n      <div info>\n        <h2>connections</h2>\n      </div>\n\n      <div cards>","</div>\n    "])),n.map(n=>this.renderConnection(n)))}renderConnection(n){var{id:e,name:t,description:i,type:r,state:a}=n,o="CONNECTED"==a;return Object(l.e)(cn||(cn=Mn(["\n      <div card ?connected=",">\n        <strong>","</strong>\n        <span>","</span>\n        <span>Type : ","</span>\n        <div buttons>\n          <mwc-icon-button\n            @click=","\n            .icon=","\n            label=","\n          ></mwc-icon-button>\n        </div>\n      </div>\n    "])),o,t,i,r,e=>o?this.disconnect(n):this.connect(n),o?"link_off":"link",o?"disconnect":"connect")}connect(n){var e=this;return Tn((function*(){var t=yield o.client.mutate({mutation:d()(dn||(dn=Mn(["\n        mutation($name: String!) {\n          connectConnection(name: $name) {\n            state\n          }\n        }\n      "]))),variables:{name:n.name}});n.state=t.data.connectConnection.state,e.requestUpdate(),document.dispatchEvent(new CustomEvent("notify",{detail:{level:"info",message:"".concat("CONNECTED"==n.state?"success":"fail"," to connect : ").concat(n.name)}}))}))()}disconnect(n){var e=this;return Tn((function*(){var t=yield o.client.mutate({mutation:d()(ln||(ln=Mn(["\n        mutation($name: String!) {\n          disconnectConnection(name: $name) {\n            state\n          }\n        }\n      "]))),variables:{name:n.name}});n.state=t.data.disconnectConnection.state,e.requestUpdate(),document.dispatchEvent(new CustomEvent("notify",{detail:{level:"info",message:"".concat("CONNECTED"==n.state?"fail":"success"," to disconnect : ").concat(n.name)}}))}))()}}function Ln(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,i)}return t}function Bn(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?Ln(Object(t),!0).forEach((function(e){Jn(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Ln(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}function Vn(n,e,t,i,r,a,o){try{var s=n[a](o),c=s.value}catch(n){return void t(n)}s.done?e(c):Promise.resolve(c).then(i,r)}function Hn(n){return function(){var e=this,t=arguments;return new Promise((function(i,r){var a=n.apply(e,t);function o(n){Vn(a,i,r,o,s,"next",n)}function s(n){Vn(a,i,r,o,s,"throw",n)}o(void 0)}))}}function Qn(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function Jn(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Fn(n){return n&&"UNLOADED"!==n}customElements.define("connections-monitor",Un);class Rn extends(Object(a.b)(a.a)(o.PageView)){static get properties(){return{scenarios:Array,pendings:Array,connections:Array,colorIndex:Object,subscribing:Boolean}}static get styles(){return[s.c,Object(l.b)(un||(un=Qn(["\n        :host {\n          display: flex;\n          flex-direction: column;\n\n          overflow: hidden;\n          background-color: var(--main-section-background-color);\n          padding: var(--padding-wide);\n        }\n\n        integration-summary {\n          margin-bottom: var(--margin-wide);\n        }\n\n        content {\n          flex: 1;\n          display: flex;\n          flex-direction: row;\n\n          overflow: hidden;\n        }\n\n        connections-monitor {\n          width: 180px;\n        }\n\n        scenarios-monitor {\n          flex: 1;\n          margin: 0 var(--margin-wide) 0 0;\n        }\n\n        @media screen and (max-width: 480px) {\n          :host {\n            padding: var(--padding-default);\n          }\n          integration-summary {\n            margin-bottom: var(--margin-default);\n          }\n          content {\n            display: block;\n            overflow: auto;\n          }\n          scenarios-monitor {\n            min-height: 350px;\n            margin: 0 0 var(--margin-default) 0;\n          }\n          connections-monitor {\n            width: initial;\n          }\n        }\n      "])))]}get context(){return{title:a.a.t("text.integration monitor"),help:"integration/ui/integration-monitor"}}render(){return Object(l.e)(pn||(pn=Qn(["\n      <integration-summary\n        .pendings=","\n        .scenarios=","\n        .connections=","\n      ></integration-summary>\n      <content>\n        <scenarios-monitor\n          .scenarios=","\n          .pendings=","\n          .colorIndex=","\n          .running=","\n        ></scenarios-monitor>\n        <connections-monitor .connections=","></connections-monitor>\n      </content>\n    "])),this.pendings,this.scenarios,this.connections,this.scenarios,this.pendings,this.colorIndex||{},this.subscribing&&this.active,this.connections)}pageUpdated(n){var e=this;return Hn((function*(){"active"in n&&(e.active?(yield e.fetchScenarios(),yield e.startSubscribe()):yield e.stopSubscribe())}))()}fetchScenarios(){var n=this;return Hn((function*(){var e=yield o.client.query({query:d()(vn||(vn=Qn(["\n        query {\n          responses: scenarios {\n            items {\n              id\n              name\n              description\n              active\n              state\n              schedule\n              timezone\n              instances {\n                instanceName\n                scenarioName\n                state\n                progress {\n                  rate\n                  steps\n                  step\n                  rounds\n                }\n                variables\n                data\n                message\n              }\n              updater {\n                id\n                name\n              }\n              updatedAt\n            }\n            total\n          }\n        }\n      "])))}),t={};n.scenarios=(e.data.responses.items||[]).map(n=>{var e=function(n){var e=0;if(0===n.length)return e;for(var t=0;t<n.length;t++)e=n.charCodeAt(t)+((e<<5)-e),e&=e;var i="#";for(t=0;t<3;t++){i+=("00"+(e>>8*t&255).toString(16)).substr(-2)}return i}(n.id);return t[n.id]=e,Bn(Bn({},n),{},{color:e})}),n.colorIndex=t}))()}startSubscribe(){var n=this;return Hn((function*(){var e,t;n.scenarioInstanceStateSubscription||(n.scenarioInstanceStateSubscription=yield Object(o.subscribe)({query:"\n            subscription {\n              scenarioInstanceState {\n                instanceName\n                scenarioName\n                state\n                progress {\n                  rate\n                  steps\n                  step\n                  rounds\n                }\n              }\n            }\n          "},{next:(e=Hn((function*({data:e}){if(e){var{scenarioName:t,instanceName:i,state:r}=e.scenarioInstanceState;n.scenarios=n.scenarios||[];var a=n.scenarios.find(n=>n.name===t);if(!a)return n.scenarios=[],yield n.stopSubscribe(),yield n.fetchScenarios(),void(yield n.startSubscribe());var o=a.instances.findIndex(n=>n.instanceName===i);-1==o?Fn(r)&&a.instances.push(e.scenarioInstanceState):Fn(r)?a.instances.splice(o,1,e.scenarioInstanceState):a.instances.splice(o,1),n.scenarios.splice(n.scenarios.indexOf(a),1,Bn({},a)),n.scenarios=[...n.scenarios]}})),function(n){return e.apply(this,arguments)})}),n.scenarioQueueStateSubscription=yield Object(o.subscribe)({query:"\n            subscription {\n              scenarioQueueState {\n                queue {\n                  stuff\n                  due\n                  priority\n                  tag\n                }\n              }\n            }\n          "},{next:({data:e})=>{e&&(n.pendings=e.scenarioQueueState.queue)}}),n.connectionStateSubscription=yield Object(o.subscribe)({query:"\n            subscription {\n              connectionState {\n                id,\n                name,\n                description,\n                type,\n                state\n              }\n            }\n          "},{next:(t=Hn((function*({data:e}){if(e){var t=e.connectionState;n.connections=n.connections||[];var i=n.connections.findIndex(n=>n.id===t.id);-1!==i?(n.connections[i]=e.connectionState,n.connections=[...n.connections]):n.connections=[...n.connections,e.connectionState]}})),function(n){return t.apply(this,arguments)})}))}))()}stopSubscribe(){var n=this;return Hn((function*(){var e,t,i;yield null===(e=n.scenarioInstanceStateSubscription)||void 0===e?void 0:e.unsubscribe(),yield null===(t=n.scenarioQueueStateSubscription)||void 0===t?void 0:t.unsubscribe(),yield null===(i=n.connectionStateSubscription)||void 0===i?void 0:i.unsubscribe(),delete n.scenarioInstanceStateSubscription,delete n.scenarioQueueStateSubscription,delete n.connectionStateSubscription}))()}}Jn(Rn,"ScenarioInstanceStatus",["READY","STARTED","STOPPED","HALTED"]),window.customElements.define("integration-monitor",Rn)},942:function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));var i=t(5);function r(n,e,t,i,r,a,o){try{var s=n[a](o),c=s.value}catch(n){return void t(n)}s.done?e(c):Promise.resolve(c).then(i,r)}
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
var a=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=n[Symbol.asyncIterator];return t?t.call(n):(n="function"==typeof __values?__values(n):n[Symbol.iterator](),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(t){e[t]=n[t]&&function(e){return new Promise((function(i,r){(function(n,e,t,i){Promise.resolve(i).then((function(e){n({value:e,done:t})}),e)})(i,r,(e=n[t](e)).done,e.value)}))}}},o=Object(i.f)((n,e)=>function(){var t,o=(t=function*(t){var r,o;if(!(t instanceof i.d))throw new Error("asyncReplace can only be used in text bindings");if(n!==t.value){var s=new i.d(t.options);t.value=n;var c=0;try{for(var d,l=a(n);!(d=yield l.next()).done;){var u=d.value;if(t.value!==n)break;0===c&&(t.clear(),s.appendIntoPart(t)),void 0!==e&&(u=e(u,c)),s.setValue(u),s.commit(),c++}}catch(n){r={error:n}}finally{try{d&&!d.done&&(o=l.return)&&(yield o.call(l))}finally{if(r)throw r.error}}}},function(){var n=this,e=arguments;return new Promise((function(i,a){var o=t.apply(n,e);function s(n){r(o,i,a,s,c,"next",n)}function c(n){r(o,i,a,s,c,"throw",n)}s(void 0)}))});return function(n){return o.apply(this,arguments)}}())}}]);